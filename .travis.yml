sudo: required

services:
  - docker

language: php

php:
  - 7.0
  - 7.1

env:
  matrix:
    - SHOPWARE_VERSION=5.2.10
    - SHOPWARE_VERSION=5.2.11
    - SHOPWARE_VERSION=5.2.12
    - SHOPWARE_VERSION=5.2.13
    - SHOPWARE_VERSION=5.2.14
    - SHOPWARE_VERSION=5.2.15
    - SHOPWARE_VERSION=5.2.16
    - SHOPWARE_VERSION=5.2.17
    - SHOPWARE_VERSION=5.2.18
    - SHOPWARE_VERSION=5.2.19
    - SHOPWARE_VERSION=5.2.20
    - SHOPWARE_VERSION=5.2.21
    - SHOPWARE_VERSION=5.2.22

install: true

before_script:
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS

script:
  - php prepare.php

after_success:
  - export IMAGE=1drop/shopware:$SHOPWARE_VERSION
  - if [ $VERSION == '7.0' ]; then export IMAGE=$IMAGE-dev
  - docker build -f Dockerfile -t $IMAGE .
  - docker push $IMAGE